{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQtd","_inputValor","_ordemAtual","_listaNegociacoes","_mensagem","_service","_init","console","log","lista","then","negociacoes","forEach","negociacao","adiciona","catch","erro","texto","window","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","limpa","esvazia","coluna","inverteOrdem","ordena","a","b","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {Mensagem} from '../models/Mensagem';\nimport {NegociacoesView} from '../views/NegociacoesView';\nimport {MensagemView} from '../views/MensagemView';\nimport {NegociacaoService} from '../services/NegociacaoService';\nimport {DateHelper} from '../helpers/DateHelper';\nimport {Bind} from '../helpers/Bind';\nimport {Negociacao} from '../models/Negociacao';\n\nexport class NegociacaoController {\n\n\tconstructor() {\n\n\t\tlet $ = document.querySelector.bind(document);\n\n\t\tthis._inputData = $('#data');\n\t\tthis._inputQtd = $('#quantidade');\n\t\tthis._inputValor = $('#valor');\n\t\tthis._ordemAtual = '';\n\t\tthis._listaNegociacoes = new Bind(new ListaNegociacoes(), new NegociacoesView($('#negociacoesView')), 'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\n\t\tthis._mensagem = new Bind(new Mensagem(), new MensagemView($('#mensagemView')), 'texto');\n\t\tthis._service = new NegociacaoService();\n\n\t\tthis._init();\n\t}\n\n\t_init() {\n\n\t\tconsole.log(\"Iniciou nosso NegociacaoController\");\n\t\t\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then((negociacoes) =>\n\t\t\t\tnegociacoes.forEach((negociacao) =>\n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t\t\t.catch((erro) => this._mensagem.texto = erro);\n\n\t\twindow.setInterval(() => {\n\t\t\tconsole.log(\"Importou\");\n\t\t\tthis.importaNegociacoes();\n\t\t}, 3000);\n\t}\n\n\tadiciona(event) {\n\n\t\tevent.preventDefault();\n\n\t\tlet negociacao = this._criaNegociacao();\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then((mensagem) => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._limpaFormulario();\n\t\t\t})\n\t\t\t.catch((erro) => this._mensagem.texto = erro);\n\t}\n\n\timportaNegociacoes() {\n\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\n\t\t\t.then((negociacoes) => negociacoes.forEach((negociacao) => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = \"Negociações do período importadas\";\n\t\t\t}))\n\t\t\t.catch((erro) => this._mensagem.texto = erro);\n\t}\n\n\tapaga() {\n\n\t\tthis._service\n\t\t\t.limpa()\n\t\t\t.then((mensagem) => {\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._listaNegociacoes.esvazia();\n\t\t\t})\n\t\t\t.catch((erro) => this._mensagem.texto = erro);\n\t}\n\n\tordena(coluna) {\n\n\t\tif (this._ordemAtual == coluna)\n\t\t\tthis._listaNegociacoes.inverteOrdem();\n\t\telse\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n\n\t\tthis._ordemAtual = coluna;\n\t}\n\n\t_criaNegociacao() {\n\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQtd.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t);\n\t}\n\n\t_limpaFormulario() {\n\n\t\tthis._inputData.value = '';\n\t\tthis._inputQtd.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\n\t\tthis._inputData.focus();\n\t}\n}"]}
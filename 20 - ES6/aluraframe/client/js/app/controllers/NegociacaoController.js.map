{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQtd","_inputValor","_ordemAtual","_listaNegociacoes","_mensagem","_service","_init","console","log","lista","then","negociacoes","forEach","negociacao","adiciona","catch","erro","texto","window","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","limpa","esvazia","coluna","inverteOrdem","ordena","a","b","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {Mensagem} from '../models/Mensagem';\nimport {NegociacoesView} from '../view/NegociacoesView';\nimport {MensagemView} from '../view/MensagemView';\nimport {NegociacaoService} from '../services/NegociacaoService';\nimport {DateHelper} from '../helpers/DateHelper';\nimport {Bind} from '../helpers/Bind';\nimport {Negociacao} from '../models/Negociacao';\n\nclass NegociacaoController {\n\n\tconstructor() {\n\n\t\tlet $ = document.querySelector.bind(document);\n\n\t\tthis._inputData = $('#data');\n\t\tthis._inputQtd = $('#quantidade');\n\t\tthis._inputValor = $('#valor');\n\t\tthis._ordemAtual = '';\n\t\tthis._listaNegociacoes = new Bind(new ListaNegociacoes(), new NegociacoesView($('#negociacoesView')), 'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\n\t\tthis._mensagem = new Bind(new Mensagem(), new MensagemView($('#mensagemView')), 'texto');\n\t\tthis._service = new NegociacaoService();\n\n\t\tthis._init();\n\t}\n\n\t_init() {\n\n\t\tconsole.log(\"Iniciou nosso NegociacaoController\");\n\t\t\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then((negociacoes) =>\n\t\t\t\tnegociacoes.forEach((negociacao) =>\n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\n\t\t\t.catch((erro) => this._mensagem.texto = erro);\n\n\t\twindow.setInterval(() => {\n\t\t\tconsole.log(\"Importou\");\n\t\t\tthis.importaNegociacoes();\n\t\t}, 3000);\n\t}\n\n\tadiciona(event) {\n\n\t\tevent.preventDefault();\n\n\t\tlet negociacao = this._criaNegociacao();\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then((mensagem) => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._limpaFormulario();\n\t\t\t})\n\t\t\t.catch((erro) => this._mensagem.texto = erro);\n\t}\n\n\timportaNegociacoes() {\n\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\n\t\t\t.then((negociacoes) => negociacoes.forEach((negociacao) => {\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\n\t\t\t\tthis._mensagem.texto = \"Negociações do período importadas\";\n\t\t\t}))\n\t\t\t.catch((erro) => this._mensagem.texto = erro);\n\t}\n\n\tapaga() {\n\n\t\tthis._service\n\t\t\t.limpa()\n\t\t\t.then((mensagem) => {\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._listaNegociacoes.esvazia();\n\t\t\t})\n\t\t\t.catch((erro) => this._mensagem.texto = erro);\n\t}\n\n\tordena(coluna) {\n\n\t\tif (this._ordemAtual == coluna)\n\t\t\tthis._listaNegociacoes.inverteOrdem();\n\t\telse\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n\n\t\tthis._ordemAtual = coluna;\n\t}\n\n\t_criaNegociacao() {\n\n\t\treturn new Negociacao(\n\t\t\tDateHelper.textoParaData(this._inputData.value),\n\t\t\tparseInt(this._inputQtd.value),\n\t\t\tparseFloat(this._inputValor.value)\n\t\t);\n\t}\n\n\t_limpaFormulario() {\n\n\t\tthis._inputData.value = '';\n\t\tthis._inputQtd.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\n\t\tthis._inputData.focus();\n\t}\n}"]}